config:
  target: 'https://ph0lcidae.auth0.com/api/v2'
  phases:
    - duration: 60
      arrivalCount: 20
  defaults:
    headers: 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6IlJqRXhSamMyTWtRME9UUTRPREZHTmpjek1rSTVNalZEUVRCQlJUWXlSVVE0TWpVME9VWkdRZyJ9.eyJpc3MiOiJodHRwczovL3BoMGxjaWRhZS5hdXRoMC5jb20vIiwic3ViIjoick1mZGF0NFZITXBnZ2Vlc1V2REJHeFdRSjR2R1lLdnJAY2xpZW50cyIsImF1ZCI6Imh0dHBzOi8vcGgwbGNpZGFlLmF1dGgwLmNvbS9hcGkvdjIvIiwiaWF0IjoxNTc4OTgyNDA4LCJleHAiOjE1NzkwNjg4MDgsImF6cCI6InJNZmRhdDRWSE1wZ2dlZXNVdkRCR3hXUUo0dkdZS3ZyIiwic2NvcGUiOiJyZWFkOmNsaWVudF9ncmFudHMgY3JlYXRlOmNsaWVudF9ncmFudHMgZGVsZXRlOmNsaWVudF9ncmFudHMgdXBkYXRlOmNsaWVudF9ncmFudHMgcmVhZDp1c2VycyB1cGRhdGU6dXNlcnMgZGVsZXRlOnVzZXJzIGNyZWF0ZTp1c2VycyByZWFkOnVzZXJzX2FwcF9tZXRhZGF0YSB1cGRhdGU6dXNlcnNfYXBwX21ldGFkYXRhIGRlbGV0ZTp1c2Vyc19hcHBfbWV0YWRhdGEgY3JlYXRlOnVzZXJzX2FwcF9tZXRhZGF0YSBjcmVhdGU6dXNlcl90aWNrZXRzIHJlYWQ6Y2xpZW50cyB1cGRhdGU6Y2xpZW50cyBkZWxldGU6Y2xpZW50cyBjcmVhdGU6Y2xpZW50cyByZWFkOmNsaWVudF9rZXlzIHVwZGF0ZTpjbGllbnRfa2V5cyBkZWxldGU6Y2xpZW50X2tleXMgY3JlYXRlOmNsaWVudF9rZXlzIHJlYWQ6Y29ubmVjdGlvbnMgdXBkYXRlOmNvbm5lY3Rpb25zIGRlbGV0ZTpjb25uZWN0aW9ucyBjcmVhdGU6Y29ubmVjdGlvbnMgcmVhZDpyZXNvdXJjZV9zZXJ2ZXJzIHVwZGF0ZTpyZXNvdXJjZV9zZXJ2ZXJzIGRlbGV0ZTpyZXNvdXJjZV9zZXJ2ZXJzIGNyZWF0ZTpyZXNvdXJjZV9zZXJ2ZXJzIHJlYWQ6ZGV2aWNlX2NyZWRlbnRpYWxzIHVwZGF0ZTpkZXZpY2VfY3JlZGVudGlhbHMgZGVsZXRlOmRldmljZV9jcmVkZW50aWFscyBjcmVhdGU6ZGV2aWNlX2NyZWRlbnRpYWxzIHJlYWQ6cnVsZXMgdXBkYXRlOnJ1bGVzIGRlbGV0ZTpydWxlcyBjcmVhdGU6cnVsZXMgcmVhZDpydWxlc19jb25maWdzIHVwZGF0ZTpydWxlc19jb25maWdzIGRlbGV0ZTpydWxlc19jb25maWdzIHJlYWQ6aG9va3MgdXBkYXRlOmhvb2tzIGRlbGV0ZTpob29rcyBjcmVhdGU6aG9va3MgcmVhZDplbWFpbF9wcm92aWRlciB1cGRhdGU6ZW1haWxfcHJvdmlkZXIgZGVsZXRlOmVtYWlsX3Byb3ZpZGVyIGNyZWF0ZTplbWFpbF9wcm92aWRlciBibGFja2xpc3Q6dG9rZW5zIHJlYWQ6c3RhdHMgcmVhZDp0ZW5hbnRfc2V0dGluZ3MgdXBkYXRlOnRlbmFudF9zZXR0aW5ncyByZWFkOmxvZ3MgcmVhZDpzaGllbGRzIGNyZWF0ZTpzaGllbGRzIGRlbGV0ZTpzaGllbGRzIHJlYWQ6YW5vbWFseV9ibG9ja3MgZGVsZXRlOmFub21hbHlfYmxvY2tzIHVwZGF0ZTp0cmlnZ2VycyByZWFkOnRyaWdnZXJzIHJlYWQ6Z3JhbnRzIGRlbGV0ZTpncmFudHMgcmVhZDpndWFyZGlhbl9mYWN0b3JzIHVwZGF0ZTpndWFyZGlhbl9mYWN0b3JzIHJlYWQ6Z3VhcmRpYW5fZW5yb2xsbWVudHMgZGVsZXRlOmd1YXJkaWFuX2Vucm9sbG1lbnRzIGNyZWF0ZTpndWFyZGlhbl9lbnJvbGxtZW50X3RpY2tldHMgcmVhZDp1c2VyX2lkcF90b2tlbnMgY3JlYXRlOnBhc3N3b3Jkc19jaGVja2luZ19qb2IgZGVsZXRlOnBhc3N3b3Jkc19jaGVja2luZ19qb2IgcmVhZDpjdXN0b21fZG9tYWlucyBkZWxldGU6Y3VzdG9tX2RvbWFpbnMgY3JlYXRlOmN1c3RvbV9kb21haW5zIHJlYWQ6ZW1haWxfdGVtcGxhdGVzIGNyZWF0ZTplbWFpbF90ZW1wbGF0ZXMgdXBkYXRlOmVtYWlsX3RlbXBsYXRlcyByZWFkOm1mYV9wb2xpY2llcyB1cGRhdGU6bWZhX3BvbGljaWVzIHJlYWQ6cm9sZXMgY3JlYXRlOnJvbGVzIGRlbGV0ZTpyb2xlcyB1cGRhdGU6cm9sZXMgcmVhZDpwcm9tcHRzIHVwZGF0ZTpwcm9tcHRzIHJlYWQ6YnJhbmRpbmcgdXBkYXRlOmJyYW5kaW5nIHJlYWQ6bG9nX3N0cmVhbXMgY3JlYXRlOmxvZ19zdHJlYW1zIGRlbGV0ZTpsb2dfc3RyZWFtcyB1cGRhdGU6bG9nX3N0cmVhbXMiLCJndHkiOiJjbGllbnQtY3JlZGVudGlhbHMifQ.gGOajxWkhNzv9hDlYOplUxX1Wzc7_TX66_9JS21kOt36TaDxxpEPh1sg8w9zMusygOzniBzyTWsyRSxH34-NPcyMm-CMcZcUM1gUtYIRGJFSDjQDkyFyr0l9ndb2iqkY7BNt9U8yDD2-FtS1V2vzHyN_KlwXx98ccKTbJSva0H7vMm6Gi0QcYnn4pcfJfCw1D_GlDNzBN1Vu1p2whE4itckxwpFwO-hkB7a0My7ZLhjLlny_n-zz6l0T_1IrK-JGwTPgZ6PwxOfE-iXUzdN1Kii4VBwbaaGY3aL5VO9U-me55qSESz1eVt87c7u2HSq3I_N7VGKTK9d1KY_hM2Xdnw'
  plugins:
    expect: {}
  ensure:
    maxErrorRate: 0
scenarios:
  # can do light functional testing here as well
  - flow:
      - get:
          name: "Search for a user"
          url: "/users?q=name%3Azelda&search_engine=v3"
          capture:
            - json: $.get_users_response.0.email 
              as: email
          expect:
            - contentType: json
            - statusCode: 200
            - equals:
              - "{{ email }}"
              - 'zelda@hyrule.not'
      - get:
          name: "Search for a user by email"
          url: "/users-by-email/email=%3Azelda%40hyrule.not&search_engine=v3"
          capture: 
            - json: $.get_users-by-email_response.0.name 
              as: name
          expect:
            - contentType: json
            - statusCode: 200
            - equals:
              - "{{ name }}"
              - 'zelda'